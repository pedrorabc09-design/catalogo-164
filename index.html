<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IGNICAR TOYS</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Montserrat',sans-serif}
body{background:#f1f5f9;color:#0f172a}

/* ===== HEADER ===== */
header{
  background:#1e293b;
  padding:32px 28px;
  color:white;
}
.header-top{
  display:flex;
  align-items:center;
  gap:24px;
}
.logo{
  height:200px;
  cursor:pointer;
}
.search-area{
  flex:1;
  display:flex;
  justify-content:center;
  gap:12px;
}
.search-area input{
  width:70%;
  max-width:560px;
  padding:14px 18px;
  border-radius:14px;
  border:none;
}
.cat-btn{
  background:#334155;
  color:white;
  border:none;
  padding:12px 16px;
  border-radius:14px;
  cursor:pointer;
  font-size:26px;
}
.icons{
  display:flex;
  gap:16px;
}
.icons img{
  width:34px;
  cursor:pointer;
}

/* ===== CATEGORIES ===== */
#categories{
  display:none;
  position:absolute;
  top:240px;
  left:50%;
  transform:translateX(-50%);
  background:white;
  width:320px;
  border-radius:16px;
  box-shadow:0 15px 40px rgba(0,0,0,.25);
  z-index:50;
}
#categories div{
  padding:16px;
  cursor:pointer;
  color:#0f172a;
  font-weight:600;
}
#categories div:hover{background:#e2e8f0}

/* ===== MAIN ===== */
main{padding:22px}
.section{margin-bottom:36px}
.section h2{margin-bottom:14px;color:#1e293b}

/* ===== SLIDER ===== */
.slider{position:relative}
.track{
  display:flex;
  gap:16px;
  overflow:hidden;
  scroll-behavior:smooth;
}

/* mobile */
@media(max-width:768px){
  .track{overflow-x:auto}
  .track::-webkit-scrollbar{display:none}
}

/* arrows desktop */
.arrow{
  position:absolute;
  top:45%;
  width:42px;
  height:42px;
  border-radius:50%;
  border:none;
  background:#1e293b;
  color:white;
  font-size:22px;
  cursor:pointer;
  z-index:10;
}
.arrow.left{left:-22px}
.arrow.right{right:-22px}
.arrow.hidden{display:none}

/* ===== CARD ===== */
.card{
  background:white;
  width:220px;
  min-width:220px;
  border-radius:18px;
  padding:14px;
  display:flex;
  flex-direction:column;
  cursor:pointer;
  position:relative;
}
.card img{
  width:100%;
  height:140px;
  object-fit:contain;
}
.card h3{
  font-size:14px;
  margin:10px 0;
}
.price{font-weight:700;color:#16a34a}
.old-price{
  text-decoration:line-through;
  color:#64748b;
  margin-right:6px;
}
.buy-btn{
  margin-top:auto;
  height:40px;
  background:#25d366;
  color:white;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  text-decoration:none;
  font-size:14px;
}
.buy-btn img{width:18px}
.buy-btn.disabled{
  background:#9ca3af;
  pointer-events:none;
}

/* ===== DISCOUNT ===== */
.discount-badge{
  position:absolute;
  top:10px;
  left:10px;
  background:#dc2626;
  color:white;
  font-size:12px;
  padding:5px 9px;
  border-radius:10px;
}

/* ===== DETAIL ===== */
#detail{display:none;padding:20px}
#detail.active{display:block}
#catalog.active{display:block}
#catalog{display:none}

.detail-box{
  background:white;
  border-radius:18px;
  padding:22px;
  width:100%;
  max-width:900px;
  margin:auto;
}
.detail-img{
  width:100%;
  height:320px;
  object-fit:contain;
}
.detail-actions{
  margin-top:20px;
  display:flex;
  gap:20px;
  align-items:center;
}
.detail-actions img{
  width:48px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <div class="header-top">
    <img src="imagenes/logo.png" class="logo" onclick="goHome()">

    <div class="search-area">
      <input id="search" placeholder="Buscar modelos...">
      <button class="cat-btn" onclick="toggleCategories()">â˜°</button>
    </div>

    <div class="icons">
      <a href="https://www.facebook.com/profile.php?id=100064895565079" target="_blank">
        <img src="imagenes/facebook.png">
      </a>
      <a href="https://wa.me/51942434659" target="_blank">
        <img src="imagenes/whatsapp-logo.png">
      </a>
    </div>
  </div>

  <div id="categories"></div>
</header>

<main>
  <div id="catalog" class="active"></div>

  <div id="detail">
    <div class="detail-box">
      <h2 id="d-name"></h2>
      <img id="d-image" class="detail-img">
      <p id="d-price"></p>
      <p id="d-stock"></p>

      <div class="detail-actions">
        <img src="imagenes/Volver.png" onclick="goHome()" alt="Volver">
        <a id="d-buy" target="_blank">
          <img src="imagenes/whatsapp-logo.png">
        </a>
      </div>
    </div>
  </div>
</main>

<script>
const catalog=document.getElementById("catalog");
const detail=document.getElementById("detail");
const search=document.getElementById("search");

const dName=document.getElementById("d-name");
const dImage=document.getElementById("d-image");
const dPrice=document.getElementById("d-price");
const dStock=document.getElementById("d-stock");
const dBuy=document.getElementById("d-buy");

let DATA={};

fetch("products.json").then(r=>r.json()).then(d=>{
  DATA=d;
  render("");
});

function render(filter=""){
  catalog.innerHTML="";

  let offers=[];
  Object.values(DATA).flat().forEach(p=>{
    if(p.discount) offers.push(p);
  });
  if(offers.length && !filter){
    catalog.appendChild(section("ðŸ”¥ Ofertas",offers));
  }

  Object.entries(DATA).forEach(([b,ps])=>{
    const filtered=ps.filter(p=>p.name.toLowerCase().includes(filter));
    if(filtered.length){
      catalog.appendChild(section(b,filtered));
    }
  });
}

search.addEventListener("input",e=>{
  render(e.target.value.toLowerCase());
});

function section(title,products){
  const s=document.createElement("div");
  s.className="section";
  s.innerHTML=`
    <h2>${title}</h2>
    <div class="slider">
      <button class="arrow left hidden">â€¹</button>
      <div class="track"></div>
      <button class="arrow right hidden">â€º</button>
    </div>`;
  const track=s.querySelector(".track");
  const left=s.querySelector(".left");
  const right=s.querySelector(".right");

  products.forEach(p=>{
    const c=document.createElement("div");
    c.className="card";
    c.onclick=()=>openDetail(p);
    c.innerHTML=`
      ${p.discount?`<div class="discount-badge">-${p.discount}%</div>`:""}
      <img src="${p.image}">
      <h3>${p.name}</h3>
      <div>
        ${p.discount?`<span class="old-price">S/ ${p.price}</span>`:""}
        <span class="price">S/ ${p.discount?p.finalPrice:p.price}</span>
      </div>
      <a class="buy-btn ${p.stock===0?"disabled":""}"
         href="${p.stock?`https://wa.me/51942434659?text=${encodeURIComponent("Hola, quiero comprar: "+p.name)}`:"#"}">
        <img src="imagenes/whatsapp-logo.png"> Comprar ahora
      </a>`;
    track.appendChild(c);
  });

  requestAnimationFrame(()=>{
    if(track.scrollWidth>track.clientWidth){
      right.classList.remove("hidden");
    }
  });

  right.onclick=()=>{
    if(track.scrollLeft + track.clientWidth < track.scrollWidth){
      track.scrollBy({left:240,behavior:"smooth"});
      left.classList.remove("hidden");
    }
  };
  left.onclick=()=>{
    track.scrollBy({left:-240,behavior:"smooth"});
  };

  return s;
}

function openDetail(p){
  catalog.classList.remove("active");
  detail.classList.add("active");

  dName.innerText=p.name;
  dImage.src=p.image;

  dPrice.innerHTML=p.discount
    ? `<span class="old-price">S/ ${p.price}</span> <span class="price">S/ ${p.finalPrice}</span>`
    : `<span class="price">S/ ${p.price}</span>`;

  dStock.innerText="Stock disponible: "+p.stock;

  if(p.stock){
    dBuy.href="https://wa.me/51942434659?text="+encodeURIComponent("Hola, quiero comprar: "+p.name);
    dBuy.style.pointerEvents="auto";
    dBuy.style.opacity="1";
  }else{
    dBuy.removeAttribute("href");
    dBuy.style.pointerEvents="none";
    dBuy.style.opacity="0.5";
  }
}

function goHome(){
  detail.classList.remove("active");
  catalog.classList.add("active");
  search.value="";
  render("");
}

function toggleCategories(){
  const c=document.getElementById("categories");
  c.style.display=c.style.display==="block"?"none":"block";
  if(!c.innerHTML){
    Object.keys(DATA).forEach(b=>{
      const d=document.createElement("div");
      d.innerText=b;
      d.onclick=()=>{
        c.style.display="none";
        catalog.innerHTML="";
        catalog.appendChild(section(b,DATA[b]));
      };
      c.appendChild(d);
    });
  }
}

document.addEventListener("click",e=>{
  const c=document.getElementById("categories");
  if(!c.contains(e.target) && !e.target.closest(".cat-btn")){
    c.style.display="none";
  }
});
</script>

</body>
</html>
