<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IGNICAR TOYS</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Montserrat',sans-serif}
body{background:#f1f5f9;color:#111}

/* ===== CABECERA ===== */
header{
  background:#1e293b;
  color:white;
  padding:16px;
}
.header-top{
  display:flex;
  align-items:center;
  gap:16px;
}
.logo{
  height:72px;
  cursor:pointer;
}
.search-box{
  flex:1;
  display:flex;
  justify-content:center;
}
.search-box input{
  width:60%;
  max-width:420px;
  padding:10px 14px;
  border-radius:8px;
  border:none;
}
.icons{
  display:flex;
  gap:12px;
}
.icons img{
  width:28px;
  height:28px;
  cursor:pointer;
}

/* ===== CATEGOR√çAS ===== */
#categories{
  display:none;
  position:absolute;
  background:white;
  top:96px;
  left:50%;
  transform:translateX(-50%);
  width:260px;
  border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  z-index:10;
}
#categories div{
  padding:12px;
  cursor:pointer;
}
#categories div:hover{
  background:#e2e8f0;
}

/* ===== SECCIONES ===== */
main{padding:20px}
.section{margin-bottom:28px}
.section h2{
  margin-bottom:10px;
  color:#1e293b;
}

/* ===== SLIDER ===== */
.slider{
  position:relative;
  overflow:hidden;
}
.track{
  display:flex;
  gap:12px;
  transition:transform .3s ease;
}
.arrow{
  position:absolute;
  top:40%;
  background:#1e293b;
  color:white;
  border:none;
  width:36px;
  height:36px;
  border-radius:50%;
  cursor:pointer;
  z-index:5;
}
.arrow.left{left:-10px}
.arrow.right{right:-10px}

/* ===== CARD ===== */
.card{
  background:white;
  width:200px;
  min-width:200px;
  border-radius:12px;
  padding:10px;
  position:relative;
  display:flex;
  flex-direction:column;
}
.card img{
  width:100%;
  height:120px;
  object-fit:contain;
}
.card h3{
  font-size:14px;
  margin:6px 0;
}
.price{font-weight:700;color:#16a34a}
.old-price{
  text-decoration:line-through;
  color:#64748b;
  margin-right:6px;
}
.buy-btn{
  margin-top:auto;
  height:36px;
  background:#25d366;
  color:white;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  text-decoration:none;
  font-size:14px;
}
.buy-btn img{width:18px}
.buy-btn.disabled{
  background:#9ca3af;
  pointer-events:none;
}

/* ===== DESCUENTO ===== */
.discount-badge{
  position:absolute;
  top:6px;
  left:6px;
  background:#dc2626;
  color:white;
  font-size:12px;
  padding:4px 6px;
  border-radius:6px;
}

/* ===== DETALLE ===== */
#detail{
  display:none;
  padding:20px;
}
#detail.active{display:block}
#catalog.active{display:block}
#catalog{display:none}

.detail-img{
  width:100%;
  max-width:420px;
  margin:auto;
}
.detail-actions{
  margin-top:16px;
  display:flex;
  gap:12px;
}
.detail-actions img{
  width:42px;
  cursor:pointer;
}

/* ===== RESPONSIVE ===== */
@media(max-width:768px){
  .arrow{display:none}
  .slider{overflow-x:auto}
  .slider::-webkit-scrollbar{display:none}
}
</style>
</head>

<body>

<header>
  <div class="header-top">
    <img src="imagenes/logo.png" class="logo" onclick="goHome()">

    <div class="search-box">
      <input id="search" placeholder="Buscar modelos..." onclick="toggleCategories()">
    </div>

    <div class="icons">
      <a href="https://www.facebook.com/profile.php?id=100064895565079" target="_blank">
        <img src="imagenes/facebook.png">
      </a>
      <a href="https://wa.me/51942434659" target="_blank">
        <img src="imagenes/whatsapp.png">
      </a>
    </div>
  </div>

  <div id="categories"></div>
</header>

<main>
  <div id="catalog" class="active"></div>

  <div id="detail">
    <h2 id="d-name"></h2>
    <img id="d-image" class="detail-img">
    <p id="d-price"></p>
    <p id="d-stock"></p>

    <div class="detail-actions">
      <img src="imagenes/volver.png" onclick="goHome()">
      <a id="d-buy" target="_blank">
        <img src="imagenes/whatsapp.png">
      </a>
    </div>
  </div>
</main>

<script>
let DATA={},active="ALL";

/* ===== LOAD ===== */
fetch("products.json").then(r=>r.json()).then(d=>{
  DATA=d;
  render();
});

/* ===== RENDER ===== */
function render(){
  const c=document.getElementById("catalog");
  c.innerHTML="";

  // OFERTAS
  let offers=[];
  Object.entries(DATA).forEach(([b,ps])=>{
    ps.forEach(p=>{
      if(p.discount){
        offers.push({...p,brand:b});
      }
    });
  });
  if(offers.length){
    c.appendChild(section("üî• Ofertas",offers,true));
  }

  Object.entries(DATA).forEach(([b,ps])=>{
    c.appendChild(section(b,ps.map(p=>({...p,brand:b}))));
  });

  buildCategories();
}

/* ===== SECTION ===== */
function section(title,products,isOffer=false){
  const s=document.createElement("div");
  s.className="section";
  s.innerHTML=`<h2>${title}</h2>
    <div class="slider">
      <button class="arrow left">‚Äπ</button>
      <div class="track"></div>
      <button class="arrow right">‚Ä∫</button>
    </div>`;
  const track=s.querySelector(".track");
  products.forEach(p=>{
    const c=document.createElement("div");
    c.className="card";
    c.onclick=()=>openDetail(p);
    c.innerHTML=`
      ${p.discount?`<div class="discount-badge">-${p.discount}%</div>`:""}
      <img src="${p.image}">
      <h3>${p.name}</h3>
      <div>
        ${p.discount?`<span class="old-price">S/ ${p.price}</span>`:""}
        <span class="price">S/ ${p.discount?p.finalPrice:p.price}</span>
      </div>
      <a class="buy-btn ${p.stock===0?"disabled":""}"
         href="${p.stock?`https://wa.me/51942434659?text=${encodeURIComponent("Hola, quiero comprar: "+p.name)}`:"#"}">
        <img src="imagenes/whatsapp.png"> Comprar ahora
      </a>`;
    track.appendChild(c);
  });

  let idx=0;
  const max=Math.max(0,products.length-4);
  s.querySelector(".left").onclick=()=>{idx=Math.max(0,idx-1);track.style.transform=`translateX(${-idx*212}px)`};
  s.querySelector(".right").onclick=()=>{idx=Math.min(max,idx+1);track.style.transform=`translateX(${-idx*212}px)`};

  if(products.length<=4){
    s.querySelector(".left").style.display="none";
    s.querySelector(".right").style.display="none";
  }

  return s;
}

/* ===== DETAIL ===== */
function openDetail(p){
  document.getElementById("catalog").classList.remove("active");
  document.getElementById("detail").classList.add("active");
  dName.innerText=p.name;
  dImage.src=p.image;
  dPrice.innerHTML=p.discount?
    `<span class="old-price">S/ ${p.price}</span> <span class="price">S/ ${p.finalPrice}</span>`:
    `<span class="price">S/ ${p.price}</span>`;
  dStock.innerText="Stock disponible: "+p.stock;
  if(p.stock){
    dBuy.href=`https://wa.me/51942434659?text=${encodeURIComponent("Hola, quiero comprar: "+p.name)}`;
    dBuy.classList.remove("disabled");
  }else{
    dBuy.removeAttribute("href");
    dBuy.classList.add("disabled");
  }
}

/* ===== HOME ===== */
function goHome(){
  document.getElementById("detail").classList.remove("active");
  document.getElementById("catalog").classList.add("active");
}

/* ===== CATEGORIES ===== */
function toggleCategories(){
  const c=document.getElementById("categories");
  c.style.display=c.style.display==="block"?"none":"block";
}
function buildCategories(){
  const c=document.getElementById("categories");
  c.innerHTML=`<div onclick="goHome()">Todos</div>`;
  Object.keys(DATA).forEach(b=>{
    const d=document.createElement("div");
    d.innerText=b;
    d.onclick=()=>{
      document.getElementById("catalog").innerHTML="";
      document.getElementById("catalog").appendChild(section(b,DATA[b].map(p=>({...p,brand:b}))));
      c.style.display="none";
    };
    c.appendChild(d);
  });
}

/* ===== CLOSE CAT ===== */
document.addEventListener("click",e=>{
  const c=document.getElementById("categories");
  if(!c.contains(e.target) && !e.target.closest(".search-box")){
    c.style.display="none";
  }
});
</script>

</body>
</html>
