<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IGNICAR TOYS</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Montserrat',sans-serif}
body{background:#f1f5f9;color:#111}

/* ===== HEADER ===== */
header{
  background:#1e293b;
  padding:18px;
  color:white;
}
.header-top{
  display:flex;
  align-items:center;
  gap:18px;
}
.logo{
  height:78px;
  cursor:pointer;
}
.search-area{
  flex:1;
  display:flex;
  justify-content:center;
  gap:8px;
}
.search-area input{
  width:55%;
  max-width:420px;
  padding:10px 14px;
  border-radius:8px;
  border:none;
}
.cat-btn{
  background:#334155;
  color:white;
  border:none;
  padding:10px 14px;
  border-radius:8px;
  cursor:pointer;
}
.icons{
  display:flex;
  gap:12px;
}
.icons img{
  width:28px;
  cursor:pointer;
}

/* ===== CATEGORIES ===== */
#categories{
  display:none;
  position:absolute;
  top:110px;
  left:50%;
  transform:translateX(-50%);
  background:white;
  width:260px;
  border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  z-index:20;
}
#categories div{
  padding:12px;
  cursor:pointer;
}
#categories div:hover{
  background:#e2e8f0;
}

/* ===== MAIN ===== */
main{padding:20px}
.section{margin-bottom:30px}
.section h2{margin-bottom:10px;color:#1e293b}

/* ===== SLIDER ===== */
.slider{
  position:relative;
}
.track{
  display:flex;
  gap:12px;
  overflow-x:auto;
  scroll-behavior:smooth;
}
.track::-webkit-scrollbar{display:none}

/* arrows only desktop */
@media(min-width:769px){
  .arrow{
    position:absolute;
    top:40%;
    width:36px;
    height:36px;
    border-radius:50%;
    border:none;
    background:#1e293b;
    color:white;
    cursor:pointer;
    z-index:5;
  }
  .arrow.left{left:-14px}
  .arrow.right{right:-14px}
}

/* ===== CARD ===== */
.card{
  background:white;
  width:200px;
  min-width:200px;
  border-radius:12px;
  padding:10px;
  display:flex;
  flex-direction:column;
  position:relative;
}
.card img{
  width:100%;
  height:120px;
  object-fit:contain;
}
.card h3{
  font-size:14px;
  margin:6px 0;
}
.price{font-weight:700;color:#16a34a}
.old-price{
  text-decoration:line-through;
  color:#64748b;
  margin-right:6px;
}
.buy-btn{
  margin-top:auto;
  height:36px;
  background:#25d366;
  color:white;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  text-decoration:none;
  font-size:14px;
}
.buy-btn img{width:18px}
.buy-btn.disabled{
  background:#9ca3af;
  pointer-events:none;
}

/* ===== DISCOUNT ===== */
.discount-badge{
  position:absolute;
  top:6px;
  left:6px;
  background:#dc2626;
  color:white;
  font-size:12px;
  padding:4px 6px;
  border-radius:6px;
}

/* ===== DETAIL ===== */
#detail{display:none}
#detail.active{display:block}
#catalog.active{display:block}
#catalog{display:none}

.detail-img{
  width:100%;
  max-width:420px;
}
.detail-actions{
  margin-top:16px;
  display:flex;
  gap:14px;
}
.detail-actions img{
  width:40px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <div class="header-top">
    <img src="imagenes/logo.png" class="logo" onclick="goHome()">

    <div class="search-area">
      <input id="search" placeholder="Buscar modelos...">
      <button class="cat-btn" onclick="toggleCategories()">Categor√≠as</button>
    </div>

    <div class="icons">
      <a href="https://www.facebook.com/profile.php?id=100064895565079" target="_blank">
        <img src="imagenes/facebook.png">
      </a>
      <a href="https://wa.me/51942434659" target="_blank">
        <img src="imagenes/whatsapp-logo.png">
      </a>
    </div>
  </div>

  <div id="categories"></div>
</header>

<main>
  <div id="catalog" class="active"></div>

  <div id="detail">
    <h2 id="d-name"></h2>
    <img id="d-image" class="detail-img">
    <p id="d-price"></p>
    <p id="d-stock"></p>
    <div class="detail-actions">
      <img src="imagenes/volver.png" onclick="goHome()">
      <a id="d-buy" target="_blank">
        <img src="imagenes/whatsapp-logo.png">
      </a>
    </div>
  </div>
</main>

<script>
let DATA={};

fetch("products.json").then(r=>r.json()).then(d=>{
  DATA=d;
  render();
});

function render(){
  const c=document.getElementById("catalog");
  c.innerHTML="";

  let offers=[];
  Object.entries(DATA).forEach(([b,ps])=>{
    ps.forEach(p=>{
      if(p.discount){
        offers.push({...p,brand:b});
      }
    });
  });
  if(offers.length){
    c.appendChild(section("üî• Ofertas",offers));
  }

  Object.entries(DATA).forEach(([b,ps])=>{
    c.appendChild(section(b,ps.map(p=>({...p,brand:b}))));
  });

  buildCategories();
}

function section(title,products){
  const s=document.createElement("div");
  s.className="section";
  s.innerHTML=`
    <h2>${title}</h2>
    <div class="slider">
      <button class="arrow left">‚Äπ</button>
      <div class="track"></div>
      <button class="arrow right">‚Ä∫</button>
    </div>`;
  const track=s.querySelector(".track");

  products.forEach(p=>{
    const c=document.createElement("div");
    c.className="card";
    c.onclick=()=>openDetail(p);
    c.innerHTML=`
      ${p.discount?`<div class="discount-badge">-${p.discount}%</div>`:""}
      <img src="${p.image}">
      <h3>${p.name}</h3>
      <div>
        ${p.discount?`<span class="old-price">S/ ${p.price}</span>`:""}
        <span class="price">S/ ${p.discount?p.finalPrice:p.price}</span>
      </div>
      <a class="buy-btn ${p.stock===0?"disabled":""}"
         href="${p.stock?`https://wa.me/51942434659?text=${encodeURIComponent("Hola, quiero comprar: "+p.name)}`:"#"}">
        <img src="imagenes/whatsapp-logo.png"> Comprar ahora
      </a>`;
    track.appendChild(c);
  });

  s.querySelector(".left").onclick=()=>track.scrollBy({left:-220,behavior:"smooth"});
  s.querySelector(".right").onclick=()=>track.scrollBy({left:220,behavior:"smooth"});

  return s;
}

function openDetail(p){
  catalog.classList.remove("active");
  detail.classList.add("active");
  dName.innerText=p.name;
  dImage.src=p.image;
  dPrice.innerHTML=p.discount?
    `<span class="old-price">S/ ${p.price}</span> <span class="price">S/ ${p.finalPrice}</span>`:
    `<span class="price">S/ ${p.price}</span>`;
  dStock.innerText="Stock disponible: "+p.stock;
  if(p.stock){
    dBuy.href=`https://wa.me/51942434659?text=${encodeURIComponent("Hola, quiero comprar: "+p.name)}`;
  }else{
    dBuy.removeAttribute("href");
  }
}

function goHome(){
  detail.classList.remove("active");
  catalog.classList.add("active");
  render();
}

function toggleCategories(){
  const c=document.getElementById("categories");
  c.style.display=c.style.display==="block"?"none":"block";
}

function buildCategories(){
  const c=document.getElementById("categories");
  c.innerHTML=`<div onclick="goHome()">Todos</div>`;
  Object.keys(DATA).forEach(b=>{
    const d=document.createElement("div");
    d.innerText=b;
    d.onclick=()=>{
      catalog.innerHTML="";
      catalog.appendChild(section(b,DATA[b].map(p=>({...p,brand:b}))));
      c.style.display="none";
    };
    c.appendChild(d);
  });
}

document.addEventListener("click",e=>{
  const c=document.getElementById("categories");
  if(!c.contains(e.target) && !e.target.closest(".cat-btn")){
    c.style.display="none";
  }
});
</script>

</body>
</html>
