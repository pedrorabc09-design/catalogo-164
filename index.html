<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>IGNICAR TOYS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f4f4;
}

/* HEADER */
header {
  background: linear-gradient(90deg, #1e1e1e, #2c2c2c);
  color: white;
  padding: 12px;
  display: flex;
  align-items: center;
  gap: 12px;
}

header img.logo {
  height: 42px;
}

header h1 {
  flex: 1;
  font-size: 20px;
  margin: 0;
}

header .icons img {
  height: 26px;
  margin-left: 10px;
  cursor: pointer;
}

/* SEARCH */
#search {
  width: 100%;
  padding: 10px;
  border: none;
  font-size: 16px;
}

/* CONTENT */
section {
  padding: 10px;
}

h2 {
  margin: 20px 0 10px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
  gap: 12px;
}

/* CARD */
.card {
  background: white;
  border-radius: 8px;
  padding: 10px;
  display: flex;
  flex-direction: column;
}

.card img {
  width: 100%;
  height: 140px;
  object-fit: cover;
  border-radius: 6px;
}

.name {
  font-weight: bold;
  font-size: 13px;
  margin: 6px 0;
}

.price {
  color: #c62828;
  font-weight: bold;
}

.old {
  text-decoration: line-through;
  font-size: 12px;
  color: #777;
}

.discount {
  background: #c62828;
  color: white;
  font-size: 11px;
  padding: 3px 6px;
  border-radius: 4px;
  display: inline-block;
  margin-bottom: 4px;
}

/* BUTTON */
.btn {
  margin-top: auto;
  background: #25d366;
  color: white;
  padding: 8px;
  border-radius: 6px;
  text-align: center;
  text-decoration: none;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  font-size: 14px;
}

.btn img {
  width: 18px;
  height: 18px;
}

.btn.disabled {
  background: #aaa;
  pointer-events: none;
}
</style>
</head>

<body>

<header>
  <img src="imagenes/logo.png" class="logo">
  <h1>IGNICAR TOYS</h1>
  <div class="icons">
    <a href="https://www.facebook.com/profile.php?id=100064895565079" target="_blank">
      <img src="imagenes/facebook.png">
    </a>
    <a href="https://wa.me/51942434659" target="_blank">
      <img src="imagenes/whatsapp-logo.png">
    </a>
  </div>
</header>

<input id="search" placeholder="Buscar modelo...">

<section id="catalog"></section>

<script>
let catalogo = {};

fetch("products.json")
  .then(r => r.json())
  .then(d => {
    catalogo = d;
    render();
  });

document.getElementById("search").addEventListener("input", render);

function render() {
  const q = document.getElementById("search").value.toLowerCase();
  const cont = document.getElementById("catalog");
  cont.innerHTML = "";

  // ðŸ”¥ OFERTAS PRIMERO
  const ofertas = [];
  for (const marca in catalogo) {
    catalogo[marca].forEach(p => {
      if (p.originalPrice && p.originalPrice > p.price &&
          p.name.toLowerCase().includes(q)) {
        ofertas.push(p);
      }
    });
  }

  if (ofertas.length) {
    cont.innerHTML += `<h2>ðŸ”¥ Productos en oferta</h2><div class="grid"></div>`;
    const grid = cont.querySelector(".grid:last-child");
    ofertas.forEach(p => grid.appendChild(cardHTML(p)));
  }

  // ðŸ§± MARCAS
  for (const marca in catalogo) {
    const items = catalogo[marca].filter(p =>
      p.name.toLowerCase().includes(q)
    );
    if (!items.length) continue;

    cont.innerHTML += `<h2>${marca}</h2><div class="grid"></div>`;
    const grid = cont.querySelector(".grid:last-child");
    items.forEach(p => grid.appendChild(cardHTML(p)));
  }
}

function cardHTML(p) {
  const card = document.createElement("div");
  card.className = "card";

  let discount = "";
  if (p.originalPrice && p.originalPrice > p.price) {
    const percent = Math.round((1 - p.price / p.originalPrice) * 100);
    discount = `<div class="discount">${percent}% OFF</div>`;
  }

  card.innerHTML = `
    ${discount}
    <img src="${p.image}">
    <div class="name">${p.name}</div>
    ${p.originalPrice ? `<div class="old">S/ ${p.originalPrice}</div>` : ""}
    <div class="price">S/ ${p.price}</div>
    <a class="btn ${p.stock === 0 ? "disabled" : ""}"
       href="https://wa.me/51942434659?text=${encodeURIComponent("Hola, me interesa: " + p.name)}"
       target="_blank">
      <img src="imagenes/whatsapp-logo.png"> Comprar ahora
    </a>
  `;
  return card;
}
</script>

</body>
</html>
