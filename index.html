<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>IGNICAR TOYS</title>

<!-- FUENTE -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  font-family:'Montserrat', sans-serif;
}

body{
  background:#f5f5f5;
  color:#222;
}

/* ================= HEADER ================= */
header{
  background:#1f2937;
  color:white;
  padding:20px;
}

.header-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:20px;
}

.logo{
  display:flex;
  align-items:center;
  gap:15px;
  cursor:pointer;
}

.logo img{
  height:80px;
}

.logo h1{
  font-size:28px;
  font-weight:700;
}

.search-container{
  flex:1;
  display:flex;
  justify-content:center;
  position:relative;
}

.search-container input{
  width:60%;
  max-width:420px;
  padding:10px 15px;
  border-radius:20px;
  border:none;
  outline:none;
}

.icons{
  display:flex;
  gap:15px;
}

.icons img{
  width:34px;
  cursor:pointer;
}

/* ================= CATEGORIES ================= */
.categories{
  display:flex;
  gap:10px;
  margin-top:15px;
  flex-wrap:wrap;
}

.categories button{
  background:#374151;
  color:white;
  border:none;
  padding:6px 14px;
  border-radius:15px;
  cursor:pointer;
}

.categories button:hover{
  background:#4b5563;
}

/* ================= SECTIONS ================= */
section{
  padding:20px;
}

.section-title{
  font-size:22px;
  margin-bottom:10px;
  font-weight:700;
}

/* ================= SLIDER ================= */
.slider{
  position:relative;
}

.cards{
  display:flex;
  gap:15px;
  overflow-x:auto;
  scroll-behavior:smooth;
  padding-bottom:10px;
}

.cards::-webkit-scrollbar{
  display:none;
}

.card{
  background:white;
  min-width:220px;
  max-width:220px;
  border-radius:12px;
  padding:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
  display:flex;
  flex-direction:column;
  cursor:pointer;
}

.card img{
  width:100%;
  height:140px;
  object-fit:contain;
}

.card h3{
  font-size:14px;
  margin:8px 0;
}

.price{
  font-weight:700;
  color:#d97706;
}

.old-price{
  text-decoration:line-through;
  color:#777;
  font-size:13px;
}

.discount-badge{
  background:red;
  color:white;
  padding:4px 6px;
  font-size:12px;
  border-radius:8px;
  align-self:flex-start;
}

.buy-btn{
  margin-top:auto;
  background:#25d366;
  color:white;
  border:none;
  border-radius:10px;
  padding:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  cursor:pointer;
}

.buy-btn img{
  width:18px;
}

.buy-btn.disabled{
  background:#9ca3af;
  cursor:not-allowed;
}

/* ================= PRODUCT DETAIL ================= */
#detail{
  display:none;
  padding:20px;
}

.detail-container{
  background:white;
  padding:20px;
  border-radius:12px;
  display:flex;
  gap:20px;
  flex-wrap:wrap;
}

.detail-container img{
  max-width:350px;
  width:100%;
  object-fit:contain;
}

.detail-info{
  flex:1;
}

.detail-info h2{
  margin-bottom:10px;
}

.back-btn{
  background:none;
  border:none;
  cursor:pointer;
  margin-bottom:15px;
}

.back-btn img{
  width:40px;
}

/* ================= RESPONSIVE ================= */
@media(max-width:768px){
  .header-top{
    flex-direction:column;
    align-items:flex-start;
  }

  .search-container input{
    width:100%;
  }

  .detail-container{
    flex-direction:column;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-top">
    <div class="logo" onclick="goHome()">
      <img src="imagenes/logo.png">
      <h1>IGNICAR TOYS</h1>
    </div>

    <div class="search-container">
      <input type="text" id="search" placeholder="Buscar modelo..." oninput="searchProducts()">
    </div>

    <div class="icons">
      <a href="https://www.facebook.com/profile.php?id=100064895565079&sk=about" target="_blank">
        <img src="imagenes/facebook.png">
      </a>
      <a href="https://wa.me/51942434659" target="_blank">
        <img src="imagenes/whatsapp-logo.png">
      </a>
    </div>
  </div>

  <div class="categories" id="categories"></div>
</header>

<section id="offers">
  <div class="section-title">ðŸ”¥ Ofertas</div>
  <div class="cards" id="offerCards"></div>
</section>

<section id="catalog"></section>

<section id="detail"></section>

<script>
let productsData = {};
let currentCategory = null;

fetch('products.json')
.then(res => res.json())
.then(data => {
  productsData = data;
  renderCategories();
  renderAll();
});

function renderCategories(){
  const catDiv = document.getElementById('categories');
  catDiv.innerHTML = '<button onclick="goHome()">Todos</button>';
  Object.keys(productsData).forEach(cat=>{
    catDiv.innerHTML += `<button onclick="filterCategory('${cat}')">${cat}</button>`;
  });
}

function renderAll(){
  renderOffers();
  renderCatalog(productsData);
}

function renderOffers(){
  const offerDiv = document.getElementById('offerCards');
  offerDiv.innerHTML='';
  Object.values(productsData).flat().forEach(p=>{
    if(p.discount){
      offerDiv.appendChild(createCard(p));
    }
  });
}

function renderCatalog(data){
  const catalog = document.getElementById('catalog');
  catalog.innerHTML='';
  Object.keys(data).forEach(cat=>{
    const section = document.createElement('div');
    section.innerHTML = `<div class="section-title">${cat}</div>`;
    const cards = document.createElement('div');
    cards.className='cards';
    data[cat].forEach(p=>cards.appendChild(createCard(p)));
    section.appendChild(cards);
    catalog.appendChild(section);
  });
}

function createCard(p){
  const card = document.createElement('div');
  card.className='card';
  card.onclick=()=>showDetail(p);

  if(p.discount){
    card.innerHTML += `<div class="discount-badge">${p.discount}% OFF</div>`;
  }

  card.innerHTML += `
    <img src="${p.image}">
    <h3>${p.name}</h3>
    ${p.discount ? `<div class="old-price">S/ ${p.price}</div>` : ''}
    <div class="price">S/ ${p.finalPrice || p.price}</div>
  `;

  const btn = document.createElement('button');
  btn.className='buy-btn';
  btn.innerHTML=`<img src="imagenes/whatsapp-logo.png"> Comprar ahora`;

  if(p.stock<=0){
    btn.classList.add('disabled');
    btn.disabled=true;
  }else{
    btn.onclick=(e)=>{
      e.stopPropagation();
      window.open(`https://wa.me/51942434659?text=Hola%20quiero%20comprar%20${encodeURIComponent(p.name)}`);
    }
  }

  card.appendChild(btn);
  return card;
}

function showDetail(p){
  document.getElementById('catalog').style.display='none';
  document.getElementById('offers').style.display='none';

  const d = document.getElementById('detail');
  d.style.display='block';
  d.innerHTML=`
    <button class="back-btn" onclick="goHome()">
      <img src="imagenes/Volver.png">
    </button>
    <div class="detail-container">
      <img src="${p.image}">
      <div class="detail-info">
        <h2>${p.name}</h2>
        <p><strong>Precio:</strong> S/ ${p.finalPrice || p.price}</p>
        <p><strong>Stock:</strong> ${p.stock}</p>
        <br>
        ${p.stock>0 ? `
        <button class="buy-btn" onclick="window.open('https://wa.me/51942434659?text=Hola%20quiero%20comprar%20${encodeURIComponent(p.name)}')">
          <img src="imagenes/whatsapp-logo.png"> Comprar ahora
        </button>` : `<p>Producto agotado</p>`}
      </div>
    </div>
  `;
}

function goHome(){
  document.getElementById('detail').style.display='none';
  document.getElementById('catalog').style.display='block';
  document.getElementById('offers').style.display='block';
}

function filterCategory(cat){
  currentCategory = cat;
  renderCatalog({[cat]:productsData[cat]});
}

function searchProducts(){
  const q = document.getElementById('search').value.toLowerCase();
  if(!q){ goHome(); renderAll(); return; }

  const result = {};
  Object.keys(productsData).forEach(cat=>{
    const matches = productsData[cat].filter(p =>
      p.name.toLowerCase().includes(q) || cat.toLowerCase().includes(q)
    );
    if(matches.length) result[cat]=matches;
  });
  renderCatalog(result);
}
</script>

</body>
</html>
